---
description: "This is the main rules for the project."
alwaysApply: true
---

You are a senior React + TypeScript engineer.

Follow these rules strictly:
- Use functional components only
- Use TypeScript everywhere, no `any`
- Prefer composition over inheritance
- Keep components small and focused (single responsibility)
- No business logic inside JSX
- No inline functions inside JSX unless memoized
- Extract logic into hooks
- Use immutable state updates only
- Prefer controlled components
- Avoid prop drilling; use context or stores
- Prefer named exports
- Do not over-abstract
- Optimize for readability first, performance second
- Follow React 18 best practices
- Assume production-grade code

Component rules:
- Props must be explicitly typed
- No default exports
- JSX must be minimal and readable
- No calculations inside JSX
- Use early returns
- Use memoization only when needed
- Styling must be separated
- Component must be testable in isolation

State rules:
- Global game state must live in a store (Zustand or equivalent)
- UI state stays local
- No derived state stored
- No mutation
- All game state changes go through actions
- No direct state writes inside components

Hooks rules:
- One responsibility per hook
- Hooks must not render JSX
- Hooks return stable APIs
- Hooks must be pure except for effects
- Side effects only inside useEffect
- All hooks typed explicitly

TypeScript rules:
- strict mode assumed
- No `any`, `unknown` only when justified
- Use union types instead of enums where possible
- Prefer readonly types for state
- Prefer explicit return types for public functions
- Discriminated unions for game logic

Game logic rules:
- No game rules inside components
- Movement logic goes in /utils
- Validation must be deterministic
- Board is the single source of truth
- Client never decides legality
- All rules must be unit-testable

All constant values used in:
- dropdowns
- selects
- filters
- enums shown to users
- game options
- feature flags
- size / mode / type selectors

MUST be defined in a dedicated config file.

All dropdown constants must follow this pattern:

- Uppercase keys
- Literal string values
- `as const`
- Exported union type derived from values

DO NOT:
- Use enums for UI-facing options
- Use magic strings in JSX
- Define options inside components
- Define values without `as const`
- Manually write union types

Helper methods MUST NEVER be defined:
- Inside components
- Inside services
- Inside controllers
- Inside hooks
- Inside gateways

Helpers must always live in a dedicated helper or utils folder.
If a helper is used across multiple features:

Place it in the root utils folder.

Helper files must:
- End with .helper.ts or .utils.ts
- Be named after their responsibility
- Export named functions only

Never:
- use comments to explain the code
- Use useEffect for derived state
- Use index as React key
- Mutate arrays or objects
- Inline complex logic in JSX
- Create god components
- Mix UI and rules